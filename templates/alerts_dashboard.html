<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard de Alertas</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <!-- FontAwesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        .priority-high { 
            background-color: #f8d7da;
            border-left: 5px solid #dc3545 !important;
        }
        .priority-medium { 
            background-color: #fff3cd;
            border-left: 5px solid #ffc107 !important;
        }
        .priority-low { 
            background-color: #d1e7dd;
            border-left: 5px solid #198754 !important;
        }
        .filter-section { 
            background-color: #f8f9fa; 
            padding: 1rem; 
            border-radius: 0.5rem; 
            margin-bottom: 1rem; 
        }
        .stats-card { 
            background-color: white; 
            padding: 1rem; 
            border-radius: 0.5rem; 
            margin-bottom: 1rem; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .stats-number { 
            font-size: 1.5rem; 
            font-weight: bold; 
        }
        .acknowledge-btn { 
            cursor: pointer; 
        }
        .acknowledge-btn:hover { 
            opacity: 0.8; 
        }
        .alert-row { 
            cursor: pointer; 
        }
        .alert-row:hover { 
            background-color: #e7f1ff; 
            color: #003366;
        }
        .severity-indicator {
            width: 4px;
            height: 100%;
            position: absolute;
            left: 0;
            top: 0;
        }
        .modal-lg {
            max-width: 800px;
        }
        .priority-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        .priority-indicator.high {
            background-color: #dc3545;
        }
        .priority-indicator.medium {
            background-color: #ffc107;
        }
        .priority-indicator.low {
            background-color: #198754;
        }
        .badge {
            font-weight: 500;
            padding: 0.5em 0.8em;
        }
        .badge.bg-high {
            background-color: #dc3545 !important;
            color: white !important;
        }
        .badge.bg-medium {
            background-color: #ffc107 !important;
            color: black !important;
        }
        .badge.bg-low {
            background-color: #28a745 !important;
            color: white !important;
        }
        .priority-high {
            background-color: rgba(220, 53, 69, 0.1);
        }
        .priority-medium {
            background-color: rgba(255, 193, 7, 0.1);
        }
        .priority-low {
            background-color: rgba(40, 167, 69, 0.1);
        }
    </style>
</head>
<body class="bg-light">
<!-- Navbar estilo base.html -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container">
    <a class="navbar-brand" href="/livelyageing/home">
      <i class="fas fa-heartbeat me-2"></i>Lively Ageing
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/livelyageing/home">
            <i class="fas fa-home me-1"></i>Bienvenido
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/livelyageing/dashboard/alerts">
            <i class="fas fa-chart-line me-1"></i>Alert Dashboard
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/livelyageing/link">
            <i class="fas fa-plus-circle me-1"></i>Enlazar Dispositivo
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/livelyageing/logout">
            <i class="fas fa-sign-out-alt me-1"></i>Cierre de sesi칩n
          </a>
        </li>
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-globe"></i> Idioma
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
            <li><a class="dropdown-item" href="?lang=es">Espa침ol</a></li>
            <li><a class="dropdown-item" href="?lang=en">English</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
<!-- Bot칩n de volver -->
<a href="javascript:history.back()" class="btn btn-outline-secondary mb-3" style="position:relative;z-index:2;">
  <i class="bi bi-arrow-left"></i> Volver
</a>
<div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-2">
        <h2 class="mb-4 text-center">游늵 Dashboard de Alertas M칠dicas</h2>
        <a href="{{ url_for('export_alerts', **filters_dict) }}" class="btn btn-outline-success ms-2" title="Exportar a CSV">
            <i class="fas fa-file-csv"></i> Exportar a CSV
        </a>
    </div>

    <!-- Resumen de Alertas -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="text-danger stats-number">{{ alerts|selectattr('priority', 'equalto', 'high')|list|length }}</div>
                <div>Alertas de Alta Prioridad</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="text-warning stats-number">{{ alerts|selectattr('priority', 'equalto', 'medium')|list|length }}</div>
                <div>Alertas de Media Prioridad</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="text-success stats-number">{{ alerts|selectattr('priority', 'equalto', 'low')|list|length }}</div>
                <div>Alertas de Baja Prioridad</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="text-primary stats-number">{{ alerts|selectattr('acknowledged', 'equalto', false)|list|length }}</div>
                <div>Alertas No Reconocidas</div>
            </div>
        </div>
    </div>

    <!-- Leyenda de Prioridades -->
    <div class="alert alert-info mb-4">
        <h5 class="mb-2"><i class="fas fa-info-circle"></i> Leyenda de Prioridades</h5>
        <div class="row">
            <div class="col-md-4">
                <div class="d-flex align-items-center">
                    <div class="priority-indicator high me-2"></div>
                    <span><strong>Alta:</strong> Requiere atenci칩n inmediata (ej: anomal칤as card칤acas)</span>
                </div>
            </div>
            <div class="col-md-4">
                <div class="d-flex align-items-center">
                    <div class="priority-indicator medium me-2"></div>
                    <span><strong>Media:</strong> Atenci칩n en las pr칩ximas horas (ej: cambios en actividad)</span>
                </div>
            </div>
            <div class="col-md-4">
                <div class="d-flex align-items-center">
                    <div class="priority-indicator low me-2"></div>
                    <span><strong>Baja:</strong> Seguimiento rutinario (ej: tendencias de sue침o)</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Filtros -->
    <div class="filter-section">
        <form method="GET" class="row g-3">
            <div class="col-md-2">
                <label class="form-label">Fecha Desde</label>
                <input type="date" class="form-control" name="date_from" value="{{ request.args.get('date_from', '') }}">
            </div>
            <div class="col-md-2">
                <label class="form-label">Fecha Hasta</label>
                <input type="date" class="form-control" name="date_to" value="{{ request.args.get('date_to', '') }}">
            </div>
            <div class="col-md-2">
                <label class="form-label">Usuario</label>
                <input type="text" class="form-control" name="user_query" placeholder="Nombre o email" value="{{ request.args.get('user_query', '') }}">
            </div>
            <div class="col-md-2">
                <label class="form-label">Tipo de Alerta</label>
                <select class="form-select" name="alert_type">
                    <option value="">Todos</option>
                    <option value="heart_rate" {% if request.args.get('alert_type') == 'heart_rate' %}selected{% endif %}>Card칤acas</option>
                    <option value="activity" {% if request.args.get('alert_type') == 'activity' %}selected{% endif %}>Actividad</option>
                    <option value="sleep" {% if request.args.get('alert_type') == 'sleep' %}selected{% endif %}>Sue침o</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label">Prioridad</label>
                <select class="form-select" name="priority">
                    <option value="">Todas</option>
                    <option value="high" {% if request.args.get('priority') == 'high' %}selected{% endif %}>Alta</option>
                    <option value="medium" {% if request.args.get('priority') == 'medium' %}selected{% endif %}>Media</option>
                    <option value="low" {% if request.args.get('priority') == 'low' %}selected{% endif %}>Baja</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label">Estado</label>
                <select class="form-select" name="acknowledged">
                    <option value="">Todos</option>
                    <option value="false" {% if request.args.get('acknowledged') == 'false' %}selected{% endif %}>No Reconocidas</option>
                    <option value="true" {% if request.args.get('acknowledged') == 'true' %}selected{% endif %}>Reconocidas</option>
                </select>
            </div>
            <div class="col-12">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="urgent_only" id="urgent_only" {% if request.args.get('urgent_only') %}checked{% endif %}>
                    <label class="form-check-label" for="urgent_only">
                        Mostrar solo alertas urgentes (sin reconocer por m치s de 24h)
                    </label>
                </div>
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-primary">Filtrar</button>
                <a href="{{ url_for('alerts_dashboard') }}" class="btn btn-outline-secondary">Limpiar Filtros</a>
            </div>
        </form>
    </div>

    <!-- Tabla de Alertas -->
    <div class="table-responsive">
        <table class="table table-bordered table-hover shadow-sm bg-white">
            <thead class="table-dark">
                <tr>
                    <th>Fecha/Hora</th>
                    <th>Tiempo desde Alerta</th>
                    <th>Usuario</th>
                    <th>Tipo de Alerta</th>
                    <th>Prioridad</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for alert in alerts %}
                <tr class="priority-{{ alert.priority|lower }} alert-row" onclick="showAlertDetails({{ alert.id }})">
                    <td>{{ alert.alert_time }}</td>
                    <td>
                        {% set time_since = ((now - alert.raw_alert_time).total_seconds() / 3600)|round %}
                        {% if time_since < 24 %}
                            {{ time_since|int }} horas
                        {% else %}
                            {{ (time_since / 24)|round|int }} d칤as
                        {% endif %}
                    </td>
                    <td>{{ alert.user_name }} ({{ alert.user_email }})</td>
                    <td>{{ alert.alert_type }}</td>
                    <td>
                        <span class="badge bg-{{ alert.priority|lower }}">
                            {{ alert.priority|title }}
                        </span>
                    </td>
                    <td>
                        {% if alert.acknowledged %}
                            <span class="badge bg-success">Reconocida</span>
                        {% else %}
                            <span class="badge bg-danger">Pendiente</span>
                            {% if time_since > 48 %}
                                <span class="badge bg-danger">Urgente</span>
                            {% endif %}
                        {% endif %}
                    </td>
                    <td>
                        {% if not alert.acknowledged %}
                        <button class="btn btn-sm btn-outline-success acknowledge-btn" 
                                onclick="showAcknowledgeModal({{ alert.id }})"
                                title="Marcar como reconocida">
                            <i class="bi bi-check-circle"></i>
                        </button>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Paginaci칩n -->
    {% if pagination and pagination.pages > 1 %}
    <div class="d-flex justify-content-center mt-4">
        <nav aria-label="Navegaci칩n de p치ginas">
            <ul class="pagination">
                {% if pagination.has_prev %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('alerts_dashboard', page=pagination.prev_num, **filters_dict) }}" aria-label="Anterior">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                {% endif %}

                {% for page_num in pagination.iter_pages() %}
                    {% if page_num %}
                        <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
                            <a class="page-link" href="{{ url_for('alerts_dashboard', page=page_num, **filters_dict) }}">{{ page_num }}</a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    {% endif %}
                {% endfor %}

                {% if pagination.has_next %}
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('alerts_dashboard', page=pagination.next_num, **filters_dict) }}" aria-label="Siguiente">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>
    </div>
    {% endif %}
</div>

<!-- Modal de Detalles de Alerta -->
<div class="modal fade" id="alertDetailsModal" tabindex="-1" aria-labelledby="alertDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="alertDetailsTitle">Detalles de la Alerta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>Informaci칩n General</h6>
                        <table class="table table-sm">
                            <tr>
                                <th>Usuario:</th>
                                <td id="modal-user"></td>
                            </tr>
                            <tr>
                                <th>Fecha/Hora:</th>
                                <td id="modal-time"></td>
                            </tr>
                            <tr>
                                <th>Tipo:</th>
                                <td id="modal-type"></td>
                            </tr>
                            <tr>
                                <th>Prioridad:</th>
                                <td id="modal-priority"></td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h6>Detalles T칠cnicos</h6>
                        <table class="table table-sm">
                            <tr>
                                <th>Valor Detectado:</th>
                                <td id="modal-triggering"></td>
                            </tr>
                            <tr>
                                <th>Umbral:</th>
                                <td id="modal-threshold"></td>
                            </tr>
                            <tr>
                                <th>Estado:</th>
                                <td id="modal-status"></td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div id="intraday-chart-container" class="row mt-4 d-none">
                    <div class="col-12">
                        <h6>Datos Intrad칤a (칔ltimas 24h)</h6>
                        <div class="chart-container" style="position: relative; height:200px;">
                            <canvas id="intraday-chart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-12">
                        <h6>Informaci칩n Adicional</h6>
                        <div id="modal-details" class="alert alert-info"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-success" id="modal-acknowledge-btn" onclick="acknowledgeAlert()">
                    <i class="bi bi-check-circle"></i> Reconocer Alerta
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Reconocimiento -->
<div class="modal fade" id="acknowledgeModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Reconocer Alerta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="acknowledgeForm">
                    <input type="hidden" id="alertId" name="alertId">
                    <div class="mb-3">
                        <label for="note" class="form-label">Nota del m칠dico:</label>
                        <textarea class="form-control" id="note" name="note" rows="3" placeholder="A침ade una nota sobre la acci칩n tomada..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick="acknowledgeAlert()">Reconocer</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Variable global para almacenar los datos de las alertas
let alertsData = [];

// Funci칩n para inicializar los datos
function initializeAlertsData() {
    try {
        alertsData = {{ alerts|tojson|safe }};
        console.log('Datos de alertas inicializados:', alertsData);
    } catch (error) {
        console.error('Error al inicializar los datos de alertas:', error);
        alertsData = [];
    }
}

// Llamar a la funci칩n de inicializaci칩n cuando se carga la p치gina
document.addEventListener('DOMContentLoaded', function() {
    initializeAlertsData();
});

// Funci칩n para mostrar detalles de la alerta
function showAlertDetails(alertId) {
    console.log('Mostrando detalles de alerta:', alertId);
    const alert = alertsData.find(a => a.id === alertId);
    if (!alert) {
        console.error('Alerta no encontrada:', alertId);
        return;
    }

    // Extraer el tipo base de la alerta
    const alertType = alert.alert_type;
    const baseAlertType = alertType.includes('_') ? alertType.split('_')[0] : alertType;
    console.log('Tipo base de alerta:', baseAlertType);

    // Configurar el t칤tulo y los detalles
    document.getElementById('alertDetailsTitle').textContent = `Detalles de la Alerta - ${alert.alert_type}`;
    document.getElementById('modal-user').textContent = `${alert.user_name} (${alert.user_email})`;
    document.getElementById('modal-time').textContent = alert.alert_time; // Ya viene formateado del backend
    document.getElementById('modal-type').textContent = alert.alert_type;
    document.getElementById('modal-priority').textContent = alert.priority.charAt(0).toUpperCase() + alert.priority.slice(1);
    document.getElementById('modal-triggering').textContent = alert.triggering_value || 'N/A';
    document.getElementById('modal-threshold').textContent = alert.threshold_value || 'N/A';
    document.getElementById('modal-status').textContent = alert.acknowledged ? 'Reconocida' : 'Pendiente';
    document.getElementById('modal-details').textContent = alert.details || 'No hay detalles adicionales';

    // Configurar el bot칩n de reconocimiento
    const acknowledgeBtn = document.getElementById('modal-acknowledge-btn');
    acknowledgeBtn.setAttribute('data-alert-id', alert.id);
    acknowledgeBtn.style.display = alert.acknowledged ? 'none' : 'block';

    // Mostrar el gr치fico solo si hay datos intrad칤a y el tipo es compatible
    const chartContainer = document.getElementById('intraday-chart-container');
    const tieneDatos = alert.intraday_data && alert.intraday_data.times && alert.intraday_data.times.length > 0;
    const tipoCompatible = ['heart_rate', 'steps', 'calories', 'active_zone_minutes'].includes(baseAlertType);
    
    console.log('Estado del gr치fico:', { tieneDatos, tipoCompatible, tipoBase: baseAlertType, intradayData: alert.intraday_data });

    if (tieneDatos && tipoCompatible) {
        chartContainer.classList.remove('d-none');
        const ctx = document.getElementById('intraday-chart').getContext('2d');
        
        // Destruir el gr치fico anterior si existe
        if (window.intradayChart) {
            window.intradayChart.destroy();
        }
        
        // Configurar colores seg칰n el tipo de alerta
        let borderColor, backgroundColor;
        switch(baseAlertType) {
            case 'heart_rate':
                borderColor = 'rgb(255, 99, 132)';
                backgroundColor = 'rgba(255, 99, 132, 0.2)';
                break;
            case 'steps':
                borderColor = 'rgb(54, 162, 235)';
                backgroundColor = 'rgba(54, 162, 235, 0.2)';
                break;
            case 'calories':
                borderColor = 'rgb(255, 206, 86)';
                backgroundColor = 'rgba(255, 206, 86, 0.2)';
                break;
            case 'active_zone_minutes':
                borderColor = 'rgb(75, 192, 192)';
                backgroundColor = 'rgba(75, 192, 192, 0.2)';
                break;
            default:
                borderColor = 'rgb(75, 192, 192)';
                backgroundColor = 'rgba(75, 192, 192, 0.2)';
        }

        // Crear el nuevo gr치fico
        window.intradayChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: alert.intraday_data.times,
                datasets: [{
                    label: getMetricLabel(baseAlertType),
                    data: alert.intraday_data.values,
                    borderColor: borderColor,
                    backgroundColor: backgroundColor,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: getYAxisLabel(baseAlertType)
                        }
                    }
                }
            }
        });
    } else {
        chartContainer.classList.add('d-none');
    }

    // Mostrar el modal
    const modal = new bootstrap.Modal(document.getElementById('alertDetailsModal'));
    modal.show();
}

// Funci칩n auxiliar para obtener la etiqueta del eje Y
function getYAxisLabel(metricType) {
    switch(metricType) {
        case 'heart_rate':
            return 'Frecuencia Card칤aca (bpm)';
        case 'steps':
            return 'Pasos';
        case 'calories':
            return 'Calor칤as';
        case 'active_zone_minutes':
            return 'Minutos Activos';
        default:
            return 'Valor';
    }
}

// Funci칩n auxiliar para obtener la etiqueta de la m칠trica
function getMetricLabel(metricType) {
    switch(metricType) {
        case 'heart_rate':
            return 'Frecuencia Card칤aca';
        case 'steps':
            return 'Pasos';
        case 'calories':
            return 'Calor칤as';
        case 'active_zone_minutes':
            return 'Minutos Activos';
        default:
            return metricType;
    }
}

function showAcknowledgeModal(alertId) {
    event.stopPropagation(); // Evitar que se abra el modal de detalles
    document.getElementById('alertId').value = alertId;
    document.getElementById('note').value = '';
    const acknowledgeModal = new bootstrap.Modal(document.getElementById('acknowledgeModal'));
    acknowledgeModal.show();
}

function acknowledgeAlert() {
    // Obtener el ID de la alerta del bot칩n o del formulario
    const alertId = document.getElementById('modal-acknowledge-btn').getAttribute('data-alert-id') || 
                   document.getElementById('alertId').value;
    
    if (!alertId) {
        console.error('No se encontr칩 el ID de la alerta');
        return;
    }
    
    console.log('Reconociendo alerta:', alertId); // Log para debugging
    
    fetch(`/livelyageing/api/alerts/${alertId}/acknowledge`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Cerrar ambos modales si est치n abiertos
            const acknowledgeModal = bootstrap.Modal.getInstance(document.getElementById('acknowledgeModal'));
            if (acknowledgeModal) {
                acknowledgeModal.hide();
            }
            const alertDetailsModal = bootstrap.Modal.getInstance(document.getElementById('alertDetailsModal'));
            if (alertDetailsModal) {
                alertDetailsModal.hide();
            }
            // Recargar la p치gina para actualizar la lista
            window.location.reload();
        } else {
            alert('Error al reconocer la alerta: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error al reconocer la alerta');
    });
}

// Inicializar cuando el documento est칠 listo
document.addEventListener('DOMContentLoaded', function() {
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
</script>
</body>
</html>
